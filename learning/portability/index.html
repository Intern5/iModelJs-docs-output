<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Bentley Docs</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" type="text/css" href="https://imodeljs.github.io/iModelJs-docs-output/styles/bundle.css">
    <link rel="stylesheet" type="text/css" href="https://imodeljs.github.io/iModelJs-docs-output/styles/prism.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">

</head>

<body data-site-root=https://imodeljs.github.io/iModelJs-docs-output/ class='indexSeg'>
    <span id="contentLoader"><p>Woah!  This page has a great deal of content...  Give us a second to load it.</p></span>
    <span id="contentLoaderBackground"></span>
    <div id="flex-wrapper">
    <header id="main-header">
        <div class='row no-gutters nav-container'>
            <!-- <div class="col-12"> -->
            
                <nav id='main-navbar' class="navbar navbar-expand-md navbar-light">
                    
                    <button class="navbar-toggler navbar-toggler-left custom-toggler" type="button" aria-controls="navbarSupportedContent" aria-expanded="false"
                        aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon">
                            <i class='icon icon-menu'></i>
                        </span>
                    </button>
                        <div class="col-sm-6 col-md-3 nav-title-container">
                            
                            <a class="navbar-brand segregated" href="https://imodeljs.github.io/iModelJs-docs-output/learning" class="col-md-3">
                                <h1 id='site-title'><i class='icon icon-document'></i>Learning</h1>                                
                            </a>

                        </div>
                        <div id='header-tabs' class='col-sm-6 col-md-3 nav-tabs-container'>
                            <nav class="navbar navbar-expand-md navbar-light">
                                 <ul class="bwc-tabs-horizontal green"><li class=""><a href="https://imodeljs.github.io/iModelJs-docs-output/overview">Overview</a></li><li class=""><a href="https://imodeljs.github.io/iModelJs-docs-output/getting-started">Getting Started</a></li><li class=""><a href="https://imodeljs.github.io/iModelJs-docs-output/bis">BIS</a></li><li class="active"><a href="https://imodeljs.github.io/iModelJs-docs-output/learning">Learning</a></li><li class=""><a href="https://imodeljs.github.io/iModelJs-docs-output/reference">Reference</a></li></ul> 
                            </nav>
                        </div>                </nav>
            
        </div>
        <!-- </div> -->

    </header>


    <div id='main-wrapper'>
    
            <div id='table-of-contents'>
                <span class='search-bar'>
                  <li>
                    <div id='search-container'>
                    </div>
                  </li>
                </span>
                
                <h3><a id="the-imodeljs-library" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a><a href="https://imodeljs.github.io/iModelJs-docs-output/learning">The iModelJs Library</a></h3>
                <ul>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/frontend">Frontend</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/backend">Backend</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/common">Common</a></li>
                </ul>
                <p>&#xA0;</p>
                <h3><a id="helpful-links" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Helpful links</h3>
                <ul>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/ecsql">ECSQL</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/featuregates">FeatureGates</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/rpcinterface">RpcInterface</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/logging">Logging</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/wireformat">Wire Format</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/faq">Frequently asked Questions</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/guidelines">Guidelines and Tips</a></li>
                <li><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/glossary">iModelJs Glossary</a></li>
                </ul>
                
            </div>
            <div class='row documentation-main'>
                <article id="main" name="main-content">
                    <div><a href="https://imodeljs.github.io/iModelJs-docs-output/learning/">learning</a> > <a href="https://imodeljs.github.io/iModelJs-docs-output/learning//"></a> > portability</div>
                    <h1 id="portability">Portability</h1>
<p>This article describes the technologies and best practices that make iModelJs apps portable. An well-written iModelJs app will run on many platforms without modification.</p>
<p>In addition, a well-written interactive app can be configured to run as a Web abb, a desktop app, and a mobile app, with a few simple runtime checks and no other code changes. Configurability does not mean that an iModelJs app must be the same in all configurations. In fact, the iModelJs architecture makes it easy to <a href="../../overview/app#making-interactive-apps-fit-the-platform">make the app fit the platform</a>.</p>
<p>This degree of portability and configurability is possible because of the technologies used by iModelJs apps and the iModelJs app architecture.</p>
<h2><a id="cross-platform-technologies" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Cross-Platform Technologies</h2>
<p>The key technology that makes an app portable is JavaScript. JavaScript engines are available on many operating systems and Web browsers. TypeScript compiles to JavaScript.</p>
<p><a href=".././glossary#node.js">Nodejs</a> is an execution environment for agents, services, and servers. Nodejs runs JavaScript programs. Nodejs itself runs on many platforms, including Windows and Linux. Nodejs is also widely supported by cloud infrastructures and deployment mechanisms.</p>
<p>Web UI technology, including HTML and CSS, makes it possible to write a cross-platform user interface that looks and behaves the same everywhere, in every configuration. Web UI technology is supported by Web browsers and Web view renderers on many platforms. Web UI technology also simplifies the task of reconfiguring or even swapping out an app&apos;s GUI.</p>
<p><a href=".././glossary#electron">Electron</a> combines a Web view client and a nodejs-based server into a single desktop product, without requiring any modification of the code or the UI. Electron runs on many desktop platforms.</p>
<h2><a id="frontend-portability" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Frontend Portability</h2>
<p>Since an iModelJs app <a href="../../overview/app#app-frontend">frontend</a> is written using Web UI technologies, it is inherently portable.</p>
<p>The frontend&apos;s main script must check the app&apos;s configuration to decide what RpcInterface configuration to use for its app-specific backend(s):</p>
<ul>
<li>Mobile app - <a href="../../overview/app#in-process-rpc-configuration">in-process RPC configuration</a>.</li>
<li>Desktop app - <a href="../../overview/app#desktop-rpc-configuration">desktop RPC configuration</a>.</li>
<li>Web app - <a href="../../overview/app#cloud-rpc-configuration">cloud PRC configuration</a>.</li>
</ul>
<p>The frontend will always use the <a href="../../overview/app#cloud-rpc-configuration">cloud RPC configuration</a> for services.</p>
<h3><a id="using-plaform-specfic-modules-in-the-frontend" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Using Plaform-specfic Modules in the Frontend</h3>
<p>In some cases, the Web view environment will provide platform-specific globals and modules. The frontend can use these modules in guarded code. To detect the platform of the frontend:</p>
<pre class="no-line-numbers language-typescript line-numbers"><code class="language-typescript"><span class="token keyword">const</span> isIos<span class="token punctuation">:</span> bool <span class="token operator">=</span> <span class="token regex">/iphone|ipod|ipad/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... other mobile platforms ...</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>isIos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... use iOS-specific modules, such as camera ...</span>
<span class="token punctuation">}</span>
</code></pre>
<h2><a id="backend-portability" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Backend Portability</h2>
<h3><a id="services-and-agents" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Services and Agents</h3>
<p>True services and agents are easy to make portable, since they always run in nodejs and they always run on a server. Services always run a Web server and always use the <a href="../../overview/app#cloud-rpc-configuration">cloud RPC configuration</a>. Note that an iModelJs service or agent does not deal directly with issues such as deployment, routing, or scaling. Those are the concerns of the cloud infrastructure. As nodejs apps, iModelJs services and agents are cloud-neutral and run on many cloud infrastructures.</p>
<h3><a id="app-backends" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>App Backends</h3>
<p>App-specific backends do not always run in nodejs, and they do not always run on a server. This section describes how to make an app-specific backend portable and adaptable to multiple app configurations.</p>
<p>An app-specific backend&apos;s main script must check the app&apos;s configuration to decide how it should initialize and run:</p>
<ul>
<li>Mobile app - the backend should run the in-process RPC request processor and use the <a href="../../overview/app#in-process-rpc-configuration">in-process RPC configuration</a>.</li>
<li>Desktop app - the backend should run a Web server and use the <a href="../../overview/app#desktop-rpc-configuration">desktop RPC configuration</a>.</li>
<li>Web app - the backend should run a Web server and use the <a href="../../overview/app#cloud-rpc-configuration">cloud RPC configuration</a>.</li>
</ul>
<p><em>Example:</em></p>
<pre class="no-line-numbers language-typescript line-numbers"><code class="language-typescript"><span class="token comment">/* Configures the RPC implementations that are implemented by this service */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initializeRpcImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Register my own interfaces</span>
  RpcManager<span class="token punctuation">.</span><span class="token function">registerImpl</span><span class="token punctuation">(</span>RobotWorldWriteRpcInterface<span class="token punctuation">,</span> RobotWorldWriteRpcImpl<span class="token punctuation">)</span><span class="token punctuation">;</span>
  RpcManager<span class="token punctuation">.</span><span class="token function">registerImpl</span><span class="token punctuation">(</span>RobotWorldReadRpcInterface<span class="token punctuation">,</span> RobotWorldReadRpcImpl<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Decide which interfaces this service will expose.</span>

  <span class="token comment">// Start with the interfaces that we know that we want to expose.</span>
  <span class="token comment">// Note that this is an example of exposing more than one interface from a single service.</span>
  <span class="token comment">// It is also an example of exposing both a interface that is implemented by an imported package</span>
  <span class="token comment">// and a interface that is implemented by the service.</span>
  <span class="token keyword">const</span> interfaces<span class="token punctuation">:</span> RpcInterfaceDefinition<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>IModelReadRpcInterface<span class="token punctuation">,</span> RobotWorldReadRpcInterface<span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// This is an example of using a FeatureGate to decide at runtime if the</span>
  <span class="token comment">// service should expose one or more interfaces.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>RobotWorldEngine<span class="token punctuation">.</span>features<span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token string">&quot;readwrite&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    interfaces<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>IModelWriteRpcInterface<span class="token punctuation">)</span><span class="token punctuation">;</span>
    interfaces<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>RobotWorldWriteRpcInterface<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Expose the RpcInterfaces using the appropriate configuration.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Platform<span class="token punctuation">.</span><span class="token function">isMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">&quot;TBD: mobile RPC config&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Platform<span class="token punctuation">.</span>electron <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ElectronRpcManager<span class="token punctuation">.</span><span class="token function">initializeImpl</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> interfaces<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    BentleyCloudRpcManager<span class="token punctuation">.</span><span class="token function">initializeImpl</span><span class="token punctuation">(</span><span class="token punctuation">{</span> info<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">&quot;RobotWorldEngine&quot;</span><span class="token punctuation">,</span> version<span class="token punctuation">:</span> <span class="token string">&quot;v1.0&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> interfaces<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


</code></pre>
<h4><a id="using-platform-specific-modules-in-the-backend" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Using Platform-specific Modules in the Backend</h4>
<p>A backend can use platform-specific globals and modules, but only in guarded code. See <a href="#backend">Platform</a> for methods to detect the platform.</p>
<p>For example, a backend can use node builtins in guarded code, like this:</p>
<pre class="no-line-numbers language-typescript line-numbers"><code class="language-typescript">  <span class="token keyword">import</span> <span class="token punctuation">{</span> Platform <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@bentley/imodeljs-backend&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>Platform<span class="token punctuation">.</span><span class="token function">isNodeJs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// access nodejs-specific modules and/or globals</span>
    __dirname<span class="token punctuation">;</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">;</span>
    <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
</code></pre>
<h3><a id="avoiding-nodejs-dependencies" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Avoiding Nodejs dependencies</h3>
<p>A backend can use the following portable imodeljs-backend classes to avoid unnecessary node dependencies:</p>
<table class="table table-responsive"><tbody><tr>
<th>Node builtin</th>
<th>imodeljs-backend portable substitute</th>
</tr>
<tr>
<td>fs</td>
<td><a href='https://imodeljs.github.io/iModelJs-docs-output/./reference/imodeljs-backend/portability/imodeljsfs'>IModelJsFs</a></td>
</tr>
<tr>
<td>os</td>
<td><a href='https://imodeljs.github.io/iModelJs-docs-output/./reference/imodeljs-backend/portability/platform'>Platform</a></td>
</tr>
<tr>
<td>process</td>
<td><a href='https://imodeljs.github.io/iModelJs-docs-output/./reference/imodeljs-backend/portability/platform'>Platform</a></td>
</tr>
<tr>
<td>__dirname</td>
<td><a href='https://imodeljs.github.io/iModelJs-docs-output/./reference/imodeljs-backend/portability/knownlocations'>KnownLocations</a></td>
</tr>
<tr>
<td>__filename</td>
<td><a href='https://imodeljs.github.io/iModelJs-docs-output/./reference/imodeljs-backend/portability/knownlocations'>KnownLocations</a></td>
</tr>
<tr>
<td>console</td>
<td>Logger</td>
</tr>
<tr>
<td>path</td>
<td><a href="#path">path</a></td>
</tr>
</tbody></table><p>In most cases, the imodeljs-backend substitutes do <em>not</em> provide all of the properties of the node global. That is by design, as not all of the features offered by node are portable.</p>
<h4><a id="path" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>path</h4>
<p>A partial implementation of <code>path</code> is provided on non-nodejs platforms. The methods that are available everywhere are:
posix, win32, sep, delimiter, basename, dirname, extname, normalize, join, isAbsolute.</p>
<p>Use only these methods in unguarded code.</p>
<h4><a id="unsupported" class="heading-anchor" href="#%s"><span>&#x1F517;</span></a>Unsupported</h4>
<p>An app backend must not <em>never</em> depend on node-specific <em>packages</em>, including any package that is based on native code. (For fs-extra, use IModelJsFs)</p>

                    <p class='last-updated'>Last Updated: 
                        <span class='date-updated'>15 May, 2018 @ 08:04:15 pm +00:00</span>
                    </p>
    
                   
                   <script type="text/javascript">
                   
                   </script>                </article>
            </div>
            <div id='inner-table-of-contents'>
                <!-- 
                    - If the page is active
                    - Get all headings and subheadings and list them
                 -->
                
                
                
                
                  <div id='sticky-container'>
                    <h4 class='heading'>Overview</h4>
                    <div id="overview-container" class="clusterize-scroll">
                      <ul id='nav' class='right-nav nav flex-column clusterize-content'>
                          <li class='nav-item item '>
                        <a class='title solo-title menu-text' href="#cross-platform-technologies">Cross-Platform Technologies</a>
                </li>
                   <li class='nav-item item '>
                        <a data-target="#inner-nav-frontend-portability" class='title' href="#frontend-portability"/>
                        <b class='dropdown-menu-title menu-text'>Frontend Portability</b>
                        <i class='dropdown icon'></i>
                        </a>
                        <ul id="inner-nav-frontend-portability" class='inner-nav'>
                            <li class='nav-item item '>
                                    <a class='title solo-title menu-text' href="#using-plaform-specfic-modules-in-the-frontend">Using Plaform-specfic Modules in the Frontend</a>
                            </li>
                        </ul>
                </li>
                   <li class='nav-item item '>
                        <a data-target="#inner-nav-backend-portability" class='title' href="#backend-portability"/>
                        <b class='dropdown-menu-title menu-text'>Backend Portability</b>
                        <i class='dropdown icon'></i>
                        </a>
                        <ul id="inner-nav-backend-portability" class='inner-nav'>
                            <li class='nav-item item '>
                                    <a class='title solo-title menu-text' href="#services-and-agents">Services and Agents</a>
                            </li>
                            <li class='nav-item item '>
                                    <a data-target="#inner-nav-app-backends" class='title' href="#app-backends"/>
                                    <b class='dropdown-menu-title menu-text'>App Backends</b>
                                    <i class='dropdown icon'></i>
                                    </a>
                                    <ul id="inner-nav-app-backends" class='inner-nav'>
                                        <li class='nav-item item '>
                                                <a class='title solo-title menu-text' href="#using-platform-specific-modules-in-the-backend">Using Platform-specific Modules in the Backend</a>
                                        </li>
                                    </ul>
                            </li>
                            <li class='nav-item item '>
                                    <a data-target="#inner-nav-avoiding-nodejs-dependencies" class='title' href="#avoiding-nodejs-dependencies"/>
                                    <b class='dropdown-menu-title menu-text'>Avoiding Nodejs dependencies</b>
                                    <i class='dropdown icon'></i>
                                    </a>
                                    <ul id="inner-nav-avoiding-nodejs-dependencies" class='inner-nav'>
                                        <li class='nav-item item '>
                                                <a class='title solo-title menu-text' href="#path">path</a>
                                        </li>
                                        <li class='nav-item item '>
                                                <a class='title solo-title menu-text' href="#unsupported">Unsupported</a>
                                        </li>
                                    </ul>
                            </li>
                        </ul>
                </li>
                 
                      </ul>
                    </div>
                  </div>
                
            </div>
        
    </div>
    

    
        <footer id='main-footer'>
            <div id='footer-content-container'>
               <div class='footer-footer'>
                   <p>Copyright 2018 Bentley Systems, Incorporated</p>
                </div>
            </div>
        </footer>
    </div>
        <a href="javascript:" id="return-to-top"><i class="icon icon-chevron-up"></i></a>
        <script src="https://imodeljs.github.io/iModelJs-docs-output/scripts/bundle.js" ></script>
    </body>
    
    </html>